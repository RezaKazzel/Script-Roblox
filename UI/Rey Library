local ReyUI = {}

local CoreGui = game:GetService("CoreGui")

local function createScreenGui(name)
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = name
    screenGui.Parent = CoreGui
    screenGui.ResetOnSpawn = false
    return screenGui
end

function ReyUI:CreateWindow(title)
    local screenGui = createScreenGui("ReyUI")

    -- Main Panel
    local panel = Instance.new("Frame")
    panel.Size = UDim2.new(0, 500, 0, 300)
    panel.Position = UDim2.new(0.5, -250, 0.5, -150)
    panel.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    panel.BorderSizePixel = 0
    panel.Visible = true
    panel.Parent = screenGui

    -- Header
    local header = Instance.new("TextLabel")
    header.Size = UDim2.new(1, 0, 0, 30)
    header.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    header.Text = title or "Rey UI"
    header.TextColor3 = Color3.fromRGB(255, 255, 255)
    header.Font = Enum.Font.GothamBold
    header.TextSize = 16
    header.Parent = panel

    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 25, 0, 25)
    closeButton.Position = UDim2.new(1, -30, 0, 2)
    closeButton.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 16
    closeButton.Parent = header

    closeButton.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)

    panel.Active = true
    panel.Draggable = true

    -- Tab Container
    local tabContainer = Instance.new("Frame")
    tabContainer.Size = UDim2.new(0, 100, 1, -30)
    tabContainer.Position = UDim2.new(0, 0, 0, 30)
    tabContainer.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    tabContainer.BorderSizePixel = 0
    tabContainer.Parent = panel

    local tabLayout = Instance.new("UIListLayout")
    tabLayout.FillDirection = Enum.FillDirection.Vertical
    tabLayout.Padding = UDim.new(0, 5)
    tabLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    tabLayout.VerticalAlignment = Enum.VerticalAlignment.Top
    tabLayout.Parent = tabContainer

    -- Right Frame for Pages
    local rightFrame = Instance.new("Frame")
    rightFrame.Size = UDim2.new(1, -100, 1, -30)
    rightFrame.Position = UDim2.new(0, 100, 0, 30)
    rightFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    rightFrame.BorderSizePixel = 0
    rightFrame.Parent = panel

    -- Add Visual Debugging for the Right Frame
    local debugFrame = Instance.new("Frame")
    debugFrame.Size = UDim2.new(1, 0, 1, 0)
    debugFrame.BackgroundColor3 = Color3.fromRGB(255, 0, 0)  -- Red outline for debugging
    debugFrame.Parent = rightFrame

    local tabs = {}

    -- AddPage Method
    function tabs:AddPage(pageName)
        -- Page
        local page = Instance.new("Frame")
        page.Size = UDim2.new(1, 0, 1, 0)
        page.BackgroundTransparency = 1
        page.Visible = true  -- Ensure it's visible
        page.Parent = rightFrame

        -- Tab Button
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(1, -10, 0, 30)
        button.BackgroundColor3 = Color3.fromRGB(85, 85, 255)
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.Font = Enum.Font.GothamBold
        button.TextSize = 14
        button.Text = pageName
        button.Parent = tabContainer

        button.MouseButton1Click:Connect(function()
            for _, child in pairs(rightFrame:GetChildren()) do
                if child:IsA("Frame") then
                    child.Visible = false
                end
            end
            page.Visible = true
        end)

        -- Add Elements to Page
        local elements = {}

        function elements:AddButton(buttonText, callback)
            local button = Instance.new("TextButton")
            button.Size = UDim2.new(0, 200, 0, 50)
            button.Position = UDim2.new(0, 0, 0, #elements * 55)  -- Adjust position based on number of elements
            button.BackgroundColor3 = Color3.fromRGB(128, 0, 128)
            button.TextColor3 = Color3.fromRGB(255, 255, 255)
            button.Text = buttonText
            button.Font = Enum.Font.GothamBold
            button.TextSize = 14
            button.Parent = page
            button.MouseButton1Click:Connect(callback)
        end

        function elements:AddToggle(toggleText, default, callback)
            local toggle = Instance.new("TextButton")
            toggle.Size = UDim2.new(0, 200, 0, 50)
            toggle.Position = UDim2.new(0, 0, 0, #elements * 55)  -- Adjust position based on number of elements
            toggle.BackgroundColor3 = default and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
            toggle.Text = toggleText
            toggle.TextColor3 = Color3.fromRGB(255, 255, 255)
            toggle.Font = Enum.Font.GothamBold
            toggle.TextSize = 14
            toggle.Parent = page

            local state = default
            toggle.MouseButton1Click:Connect(function()
                state = not state
                toggle.BackgroundColor3 = state and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
                callback(state)
            end)
        end

        function elements:AddTextBox(defaultText, callback)
            local textbox = Instance.new("TextBox")
            textbox.Size = UDim2.new(0, 200, 0, 50)
            textbox.Position = UDim2.new(0, 0, 0, #elements * 55)  -- Adjust position based on number of elements
            textbox.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
            textbox.TextColor3 = Color3.fromRGB(255, 255, 255)
            textbox.Font = Enum.Font.GothamBold
            textbox.TextSize = 14
            textbox.Text = defaultText or ""
            textbox.Parent = page

            textbox.FocusLost:Connect(function()
                callback(textbox.Text)
            end)
        end

        function elements:AddDropdown(options, defaultChoice, callback)
            local dropdownButton = Instance.new("TextButton")
            dropdownButton.Size = UDim2.new(0, 200, 0, 50)
            dropdownButton.Position = UDim2.new(0, 0, 0, #elements * 55)  -- Adjust position based on number of elements
            dropdownButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
            dropdownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            dropdownButton.Font = Enum.Font.GothamBold
            dropdownButton.TextSize = 14
            dropdownButton.Text = defaultChoice or "Choose an option"
            dropdownButton.Parent = page

            local dropdownMenu = Instance.new("Frame")
            dropdownMenu.Size = UDim2.new(0, 200, 0, 0)
            dropdownMenu.Position = UDim2.new(0, 0, 0, 50)
            dropdownMenu.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            dropdownMenu.Parent = page
            dropdownMenu.Visible = false

            local listLayout = Instance.new("UIListLayout")
            listLayout.Parent = dropdownMenu
            listLayout.FillDirection = Enum.FillDirection.Vertical
            listLayout.Padding = UDim.new(0, 5)

            for _, option in ipairs(options) do
                local optionButton = Instance.new("TextButton")
                optionButton.Size = UDim2.new(1, 0, 0, 30)
                optionButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                optionButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                optionButton.Text = option
                optionButton.Parent = dropdownMenu

                optionButton.MouseButton1Click:Connect(function()
                    dropdownButton.Text = option
                    dropdownMenu.Visible = false
                    callback(option)
                end)
            end

            dropdownButton.MouseButton1Click:Connect(function()
                dropdownMenu.Visible = not dropdownMenu.Visible
            end)
        end

        return elements
    end

    -- Add Hide/Show Button
    local toggleButton = Instance.new("TextButton")
    toggleButton.Size = UDim2.new(0, 70, 0, 30)
    toggleButton.Position = UDim2.new(1, -80, 0, 10)
    toggleButton.BackgroundColor3 = Color3.fromRGB(148, 0, 211)
    toggleButton.Text = "Rey"
    toggleButton.TextColor3 = Color3.new(1, 1, 1)
    toggleButton.Font = Enum.Font.GothamBold
    toggleButton.TextSize = 14
    toggleButton.Parent = screenGui

    toggleButton.MouseButton1Click:Connect(function()
        panel.Visible = not panel.Visible
    end)

    return tabs
end

return ReyUI
